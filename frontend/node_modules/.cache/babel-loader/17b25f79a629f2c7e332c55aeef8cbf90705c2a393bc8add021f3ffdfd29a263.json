{"ast":null,"code":"import React,{useState}from'react';import{Routes,Route,Navigate,Link,useLocation}from'react-router-dom';import MainPage from'./components/MainPage';import LoginPage from'./components/LoginPage';import RegisterPage from'./components/RegisterPage';import GoodsManagement from'./components/GoodsManagement';import AddProductPage from'./components/AddProductPage';import EditProductPage from'./components/EditProductPage';import ShoppingCartDrawer from'./components/ShoppingCartDrawer';import{ShoppingCartIcon}from'@heroicons/react/24/outline';import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";function App(){const[user,setUser]=useState(null);const[cartOpen,setCartOpen]=useState(false);const[searchKeyword,setSearchKeyword]=useState('');// 因为 index.js 已经用 BrowserRouter 包裹了 App，所以此处可以直接使用 useLocation\nconst location=useLocation();// 如果当前路径是 \"/login\" 或 \"/register\"，则不显示搜索栏\nconst showSearchBar=location.pathname!=='/login'&&location.pathname!=='/register';const handleLogin=userData=>{setUser(userData);};const handleLogout=()=>{setUser(null);};return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"nav\",{className:\"bg-black text-white sticky top-0 z-50 px-4 sm:px-6 lg:px-8 py-3 shadow\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"max-w-7xl mx-auto flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-6\",children:[/*#__PURE__*/_jsx(Link,{to:\"/\",children:/*#__PURE__*/_jsx(\"img\",{src:\"/logo.jpg\",alt:\"ECSite\",className:\"h-16 w-auto\"})}),(user===null||user===void 0?void 0:user.role)==='merchant'&&/*#__PURE__*/_jsx(Link,{to:\"/goods\",className:\"text-sm border border-white px-3 py-1.5 rounded hover:bg-white hover:text-black transition\",children:\"Manage Products\"})]}),showSearchBar&&/*#__PURE__*/_jsx(\"div\",{className:\"w-full sm:w-1/2\",children:/*#__PURE__*/_jsx(\"input\",{type:\"text\",placeholder:\"\\uD83D\\uDD0D Search products by name\",value:searchKeyword,onChange:e=>setSearchKeyword(e.target.value),className:\"w-full px-4 py-2 text-black border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-400\"})}),/*#__PURE__*/_jsx(\"div\",{className:\"flex items-center space-x-4\",children:user?/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(\"span\",{className:\"text-sm\",children:[\"Hi, \",user.username]}),user.role==='customer'&&/*#__PURE__*/_jsx(\"button\",{onClick:()=>setCartOpen(true),className:\"relative p-1 hover:text-indigo-400\",title:\"Shopping Cart\",children:/*#__PURE__*/_jsx(ShoppingCartIcon,{className:\"h-6 w-6\"})}),/*#__PURE__*/_jsx(\"button\",{onClick:handleLogout,className:\"text-sm border border-white hover:bg-white hover:text-black px-3 py-1 rounded transition\",children:\"Logout\"})]}):/*#__PURE__*/_jsx(Link,{to:\"/login\",children:/*#__PURE__*/_jsx(\"button\",{className:\"text-sm border border-white text-white px-4 py-1.5 rounded hover:bg-white hover:text-black transition\",children:\"Sign In\"})})})]})}),/*#__PURE__*/_jsxs(Routes,{children:[/*#__PURE__*/_jsx(Route,{path:\"/\",element:/*#__PURE__*/_jsx(MainPage,{user:user,searchKeyword:searchKeyword,setSearchKeyword:setSearchKeyword})}),/*#__PURE__*/_jsx(Route,{path:\"/login\",element:/*#__PURE__*/_jsx(LoginPage,{onLogin:handleLogin})}),/*#__PURE__*/_jsx(Route,{path:\"/register\",element:/*#__PURE__*/_jsx(RegisterPage,{onRegister:handleLogin})}),/*#__PURE__*/_jsx(Route,{path:\"/goods\",element:(user===null||user===void 0?void 0:user.role)==='merchant'?/*#__PURE__*/_jsx(GoodsManagement,{user:user}):/*#__PURE__*/_jsx(Navigate,{to:\"/login\"})}),/*#__PURE__*/_jsx(Route,{path:\"/add-product\",element:(user===null||user===void 0?void 0:user.role)==='merchant'?/*#__PURE__*/_jsx(AddProductPage,{user:user}):/*#__PURE__*/_jsx(Navigate,{to:\"/login\"})}),/*#__PURE__*/_jsx(Route,{path:\"/edit-product/:id\",element:/*#__PURE__*/_jsx(EditProductPage,{user:user})})]}),(user===null||user===void 0?void 0:user.role)==='customer'&&/*#__PURE__*/_jsx(ShoppingCartDrawer,{username:user.username,open:cartOpen,setOpen:setCartOpen})]});}export default App;","map":{"version":3,"names":["React","useState","Routes","Route","Navigate","Link","useLocation","MainPage","LoginPage","RegisterPage","GoodsManagement","AddProductPage","EditProductPage","ShoppingCartDrawer","ShoppingCartIcon","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","App","user","setUser","cartOpen","setCartOpen","searchKeyword","setSearchKeyword","location","showSearchBar","pathname","handleLogin","userData","handleLogout","children","className","to","src","alt","role","type","placeholder","value","onChange","e","target","username","onClick","title","path","element","onLogin","onRegister","open","setOpen"],"sources":["/data/ECSite-demo/frontend/src/App.js"],"sourcesContent":["import React, { useState } from 'react';\nimport {\n  Routes,\n  Route,\n  Navigate,\n  Link,\n  useLocation\n} from 'react-router-dom';\nimport MainPage from './components/MainPage';\nimport LoginPage from './components/LoginPage';\nimport RegisterPage from './components/RegisterPage';\nimport GoodsManagement from './components/GoodsManagement';\nimport AddProductPage from './components/AddProductPage';\nimport EditProductPage from './components/EditProductPage';\nimport ShoppingCartDrawer from './components/ShoppingCartDrawer';\nimport { ShoppingCartIcon } from '@heroicons/react/24/outline';\n\nfunction App() {\n  const [user, setUser] = useState(null);\n  const [cartOpen, setCartOpen] = useState(false);\n  const [searchKeyword, setSearchKeyword] = useState('');\n\n  // 因为 index.js 已经用 BrowserRouter 包裹了 App，所以此处可以直接使用 useLocation\n  const location = useLocation();\n  // 如果当前路径是 \"/login\" 或 \"/register\"，则不显示搜索栏\n  const showSearchBar = location.pathname !== '/login' && location.pathname !== '/register';\n\n  const handleLogin = (userData) => {\n    setUser(userData);\n  };\n\n  const handleLogout = () => {\n    setUser(null);\n  };\n\n  return (\n    <>\n      {/* 顶部导航 */}\n      <nav className=\"bg-black text-white sticky top-0 z-50 px-4 sm:px-6 lg:px-8 py-3 shadow\">\n        <div className=\"max-w-7xl mx-auto flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4\">\n          {/* 左侧：Logo + 商家入口 */}\n          <div className=\"flex items-center space-x-6\">\n            <Link to=\"/\">\n              <img\n                src=\"/logo.jpg\"\n                alt=\"ECSite\"\n                className=\"h-16 w-auto\"\n              />\n            </Link>\n            {user?.role === 'merchant' && (\n              <Link\n                to=\"/goods\"\n                className=\"text-sm border border-white px-3 py-1.5 rounded hover:bg-white hover:text-black transition\"\n              >\n                Manage Products\n              </Link>\n            )}\n          </div>\n\n          {/* 中间：搜索栏（隐藏在 /login 和 /register 页面） */}\n          {showSearchBar && (\n            <div className=\"w-full sm:w-1/2\">\n              <input\n                type=\"text\"\n                placeholder=\"🔍 Search products by name\"\n                value={searchKeyword}\n                onChange={e => setSearchKeyword(e.target.value)}\n                className=\"w-full px-4 py-2 text-black border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-400\"\n              />\n            </div>\n          )}\n\n          {/* 右侧：认证状态 / 购物车 */}\n          <div className=\"flex items-center space-x-4\">\n            {user ? (\n              <>\n                <span className=\"text-sm\">Hi, {user.username}</span>\n                {user.role === 'customer' && (\n                  <button\n                    onClick={() => setCartOpen(true)}\n                    className=\"relative p-1 hover:text-indigo-400\"\n                    title=\"Shopping Cart\"\n                  >\n                    <ShoppingCartIcon className=\"h-6 w-6\" />\n                  </button>\n                )}\n                <button\n                  onClick={handleLogout}\n                  className=\"text-sm border border-white hover:bg-white hover:text-black px-3 py-1 rounded transition\"\n                >\n                  Logout\n                </button>\n              </>\n            ) : (\n              <Link to=\"/login\">\n                <button className=\"text-sm border border-white text-white px-4 py-1.5 rounded hover:bg-white hover:text-black transition\">\n                  Sign In\n                </button>\n              </Link>\n            )}\n          </div>\n        </div>\n      </nav>\n\n      {/* 页面路由 */}\n      <Routes>\n        <Route\n          path=\"/\"\n          element={\n            <MainPage\n              user={user}\n              searchKeyword={searchKeyword}\n              setSearchKeyword={setSearchKeyword}\n            />\n          }\n        />\n        <Route path=\"/login\" element={<LoginPage onLogin={handleLogin} />} />\n        <Route path=\"/register\" element={<RegisterPage onRegister={handleLogin} />} />\n        <Route\n          path=\"/goods\"\n          element={\n            user?.role === 'merchant' ? (\n              <GoodsManagement user={user} />\n            ) : (\n              <Navigate to=\"/login\" />\n            )\n          }\n        />\n        <Route\n          path=\"/add-product\"\n          element={\n            user?.role === 'merchant' ? (\n              <AddProductPage user={user} />\n            ) : (\n              <Navigate to=\"/login\" />\n            )\n          }\n        />\n        <Route path=\"/edit-product/:id\" element={<EditProductPage user={user} />} />\n      </Routes>\n\n      {/* 购物车抽屉：仅当用户角色为 customer 时显示 */}\n      {user?.role === 'customer' && (\n        <ShoppingCartDrawer\n          username={user.username}\n          open={cartOpen}\n          setOpen={setCartOpen}\n        />\n      )}\n    </>\n  );\n}\n\nexport default App;\n\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}