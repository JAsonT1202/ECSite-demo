{"ast":null,"code":"// src/components/GoodsManagement.js\nimport React,{useEffect,useState}from'react';import axios from'axios';import{useNavigate}from'react-router-dom';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";function GoodsManagement(_ref){let{user}=_ref;const[products,setProducts]=useState([]);const API_BASE_URL=\"/api\";const navigate=useNavigate();const loadProducts=()=>{axios.get(`${API_BASE_URL}/products`).then(res=>{setProducts(res.data.filter(p=>p.addedBy===user.username));}).catch(err=>console.error(\"Failed to load products\",err));};useEffect(()=>{loadProducts();},[user]);const handleDeleteProduct=id=>{axios.delete(`${API_BASE_URL}/products/${id}`,{data:{username:user.username}}).then(()=>loadProducts()).catch(err=>{var _err$response,_err$response$data;return alert(((_err$response=err.response)===null||_err$response===void 0?void 0:(_err$response$data=_err$response.data)===null||_err$response$data===void 0?void 0:_err$response$data.detail)||\"Failed to delete product\");});};const handleUpdateProduct=product=>{navigate(`/edit-product/${product.id}`);};return/*#__PURE__*/_jsx(\"div\",{className:\"bg-white min-h-screen px-4 py-12\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"max-w-7xl mx-auto\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between items-center mb-8\",children:[/*#__PURE__*/_jsx(\"h1\",{className:\"text-2xl font-bold text-gray-800\",children:\"Product Management\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>navigate('/add-product'),className:\"bg-indigo-600 hover:bg-indigo-500 text-white px-4 py-2 rounded-md shadow\",children:\"Add New Product\"})]}),products.length===0?/*#__PURE__*/_jsx(\"p\",{className:\"text-center text-gray-500 mt-10\",children:\"You haven't added any products yet.\"}):/*#__PURE__*/_jsx(\"div\",{className:\"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6\",children:products.map(product=>/*#__PURE__*/_jsxs(\"div\",{className:\"bg-gray-50 border rounded-lg shadow-sm p-4 flex flex-col\",children:[product.imageUrl&&/*#__PURE__*/_jsx(\"img\",{src:`/api/${product.imageUrl}`,alt:product.name,className:\"w-full h-48 object-cover rounded-md mb-4\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex-grow\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-lg font-semibold text-gray-800\",children:product.name}),/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-gray-500\",children:product.category}),/*#__PURE__*/_jsxs(\"p\",{className:\"text-sm text-gray-500\",children:[\"Stock: \",product.stock]}),/*#__PURE__*/_jsxs(\"p\",{className:\"text-sm text-gray-500\",children:[\"\\xA5\",product.price]}),product.description&&/*#__PURE__*/_jsx(\"p\",{className:\"text-xs text-gray-400 mt-1 line-clamp-2\",children:product.description})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"mt-4 flex space-x-2\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>handleUpdateProduct(product),className:\"flex-1 bg-yellow-500 hover:bg-yellow-600 text-white py-1.5 rounded\",children:\"Edit\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>handleDeleteProduct(product.id),className:\"flex-1 bg-red-500 hover:bg-red-600 text-white py-1.5 rounded\",children:\"Delete\"})]})]},product.id))})]})});}export default GoodsManagement;","map":{"version":3,"names":["React","useEffect","useState","axios","useNavigate","jsx","_jsx","jsxs","_jsxs","GoodsManagement","_ref","user","products","setProducts","API_BASE_URL","navigate","loadProducts","get","then","res","data","filter","p","addedBy","username","catch","err","console","error","handleDeleteProduct","id","delete","_err$response","_err$response$data","alert","response","detail","handleUpdateProduct","product","className","children","onClick","length","map","imageUrl","src","alt","name","category","stock","price","description"],"sources":["/data/ECSite-demo/frontend/src/components/GoodsManagement.js"],"sourcesContent":["// src/components/GoodsManagement.js\nimport React, { useEffect, useState } from 'react';\nimport axios from 'axios';\nimport { useNavigate } from 'react-router-dom';\n\nfunction GoodsManagement({ user }) {\n  const [products, setProducts] = useState([]);\n  const API_BASE_URL = \"/api\";\n\n  const navigate = useNavigate();\n\n  const loadProducts = () => {\n    axios.get(`${API_BASE_URL}/products`)\n      .then(res => {\n        setProducts(res.data.filter(p => p.addedBy === user.username));\n      })\n      .catch(err => console.error(\"Failed to load products\", err));\n  };\n\n  useEffect(() => {\n    loadProducts();\n  }, [user]);\n\n  const handleDeleteProduct = (id) => {\n    axios.delete(`${API_BASE_URL}/products/${id}`, { data: { username: user.username } })\n      .then(() => loadProducts())\n      .catch(err => alert(err.response?.data?.detail || \"Failed to delete product\"));\n  };\n\n  const handleUpdateProduct = (product) => {\n    navigate(`/edit-product/${product.id}`);\n  };\n\n  return (\n    <div className=\"bg-white min-h-screen px-4 py-12\">\n      <div className=\"max-w-7xl mx-auto\">\n        <div className=\"flex justify-between items-center mb-8\">\n          <h1 className=\"text-2xl font-bold text-gray-800\">Product Management</h1>\n          <button\n            onClick={() => navigate('/add-product')}\n            className=\"bg-indigo-600 hover:bg-indigo-500 text-white px-4 py-2 rounded-md shadow\"\n          >\n            Add New Product\n          </button>\n        </div>\n\n        {products.length === 0 ? (\n          <p className=\"text-center text-gray-500 mt-10\">You haven't added any products yet.</p>\n        ) : (\n          <div className=\"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6\">\n            {products.map(product => (\n              <div key={product.id} className=\"bg-gray-50 border rounded-lg shadow-sm p-4 flex flex-col\">\n                {product.imageUrl && (\n                  <img\n                    src={`/api/${product.imageUrl}`}\n                    alt={product.name}\n                    className=\"w-full h-48 object-cover rounded-md mb-4\"\n                  />\n                )}\n                <div className=\"flex-grow\">\n                  <h2 className=\"text-lg font-semibold text-gray-800\">{product.name}</h2>\n                  <p className=\"text-sm text-gray-500\">{product.category}</p>\n                  <p className=\"text-sm text-gray-500\">Stock: {product.stock}</p>\n                  <p className=\"text-sm text-gray-500\">Â¥{product.price}</p>\n                  {product.description && (\n                    <p className=\"text-xs text-gray-400 mt-1 line-clamp-2\">{product.description}</p>\n                  )}\n                </div>\n                <div className=\"mt-4 flex space-x-2\">\n                  <button\n                    onClick={() => handleUpdateProduct(product)}\n                    className=\"flex-1 bg-yellow-500 hover:bg-yellow-600 text-white py-1.5 rounded\"\n                  >\n                    Edit\n                  </button>\n                  <button\n                    onClick={() => handleDeleteProduct(product.id)}\n                    className=\"flex-1 bg-red-500 hover:bg-red-600 text-white py-1.5 rounded\"\n                  >\n                    Delete\n                  </button>\n                </div>\n              </div>\n            ))}\n          </div>\n        )}\n      </div>\n    </div>\n  );\n}\n\nexport default GoodsManagement;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}